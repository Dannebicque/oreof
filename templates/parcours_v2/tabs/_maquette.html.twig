<turbo-frame id="tab-content">
    {{ include('parcours_v2/tabs/_header.html.twig', {tabKey: 'maquette'}) }}

    <div class="flex-1 overflow-y-auto mt-4 custom-scrollbar">
        {% form_theme form 'communs/form_theme_v2.html.twig' %}
        {{ form_start(form, {
            attr: {
                id: 'tab_form_maquette',
                'data-controller': 'autosave',
                'data-autosave-url-value': path('parcours_v2_tab_autosave', { id: parcours.id, tabKey: 'maquette' }),
                'data-action': 'change->autosave#queue'

            }
        }) }}

        {{ form_widget(form) }}
        {{ form_end(form) }}

        {#        {% if tabStates['maquette'] is defined and tabStates['maquette'].done == true %} #}
        {#            <twig:alerte type="warning" #}
        {#                         message="Cette opération permet de générer la structure (créer les semestres) selon les semestres indiquez ci-dessus. Attention, si une structure existe déjà elle sera mise à jour."></twig:alerte> #}
        {#            #}{# todo: gérer un confirm ? #}
        {#            <twig:Button #}
        {#                    href="{{ path('parcours_structure_genere', {parcours: parcours.id}) }}" #}
        {#                    submitLabel="Générer la structure"></twig:Button> #}
        {#        {% endif %} #}
        <table class="min-w-full divide-y divide-gray-200 mt-4">
            <thead class="bg-gray-50">
            <tr>
                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Année /
                    Semestre
                </th>
                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Dispensé</th>
                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Statut</th>
            </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
            {% for annee in parcours.annees %}
                <tr class="hover:bg-gray-50">
                    <td class="px-4 py-3 font-semibold text-gray-700">Année {{ annee.ordre }}</td>
                    <td class="px-4 py-3 text-sm text-gray-500">—</td>
                    <td class="px-4 py-3">
                        {% if annee.isOuvert %}
                            <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                <svg class="w-3 h-3 mr-1 text-green-600" fill="currentColor" viewBox="0 0 8 8"
                                     aria-hidden="true"><circle cx="4" cy="4" r="4"/></svg>
                                Ouvert
                            </span>
                        {% else %}
                            <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">
                                <svg class="w-3 h-3 mr-1 text-red-600" fill="currentColor" viewBox="0 0 8 8"
                                     aria-hidden="true"><circle cx="4" cy="4" r="4"/></svg>
                                Non ouvert
                            </span>
                        {% endif %}
                    </td>
                </tr>

                {% for semestre in annee.parcoursSemestre %}
                    <tr class="hover:bg-gray-50">
                        <td class="px-4 py-2 text-sm text-gray-600 pl-8">S{{ semestre.ordre }}</td>
                        <td class="px-4 py-2 text-sm text-gray-500">—</td>
                        <td class="px-4 py-2">
                            {% if semestre.isOuvert %}
                                <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-50 text-green-700">
                                    <svg class="w-3 h-3 mr-1 text-green-600" fill="currentColor" viewBox="0 0 8 8"
                                         aria-hidden="true"><circle cx="4" cy="4" r="4"/></svg>
                                    Ouvert
                                </span>
                            {% else %}
                                <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-50 text-red-700">
                                    <svg class="w-3 h-3 mr-1 text-red-600" fill="currentColor" viewBox="0 0 8 8"
                                         aria-hidden="true"><circle cx="4" cy="4" r="4"/></svg>
                                    Non ouvert
                                </span>
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
            {% endfor %}
            </tbody>
        </table>
    </div>
</turbo-frame>

